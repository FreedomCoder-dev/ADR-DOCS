# ADR - Выбор Архитектурного Подхода

**Участники:**
- Мухорин
- Мухин
- Пряшников

**Дата:** 21 сент. 2024 г.

**Статус:** Решается

## Контекст

Надо разработать систему онлайн документов с возможностью совместного доступа и редактирования

## Рассматриваемые Варианты

При разработке системы онлайн редактирования документов выбор архитектурного решения играет ключевую роль в определении производительности, масштабируемости и надежности системы. Рассмотрим плюсы и минусы каждого из предложенных вариантов: бессерверного, серверного и P2P.

- Бессерверная Архитектура
  
  - Плюсы
    - **Масштабируемость:** Автоматическое масштабирование в зависимости от нагрузки позволяет эффективно обрабатывать переменные объемы трафика.
    - **Упрощенное управление:** Нет необходимости управлять серверами, что снижает операционные затраты и позволяет сосредоточиться на разработке функционала.
    - **Оплата по факту использования:** Вы платите только за фактическое использование ресурсов, что может быть экономически выгодным при непостоянной нагрузке.
    
  - Минусы
    - **Ограничения по времени выполнения:** Функции могут иметь ограничения по времени выполнения (например, AWS Lambda имеет ограничение в 15 минут).
    - **Задержки:** Возможны задержки при холодном старте функций, что может негативно сказаться на пользовательском опыте.
    - **Сложности в отладке:** Отладка и мониторинг могут быть сложнее по сравнению с традиционной серверной архитектурой.
    
- Серверная Архитектура
    
  - Плюсы
    - **Контроль над инфраструктурой:** Полный контроль над серверной частью позволяет более гибко настраивать систему под специфические требования.
    - **Постоянное соединение:** Легче поддерживать постоянные соединения для синхронизации данных в реальном времени.
    - **Более простая отладка:** Локальная среда разработки и отладки может быть проще в настройке и использовании.
    
  - Минусы
    - **Масштабируемость:** Масштабирование требует дополнительных усилий и может быть сложным при резком увеличении нагрузки.
    - **Операционные затраты:** Необходимость управления серверами увеличивает операционные затраты и требует дополнительных ресурсов.
    - **Резервирование ресурсов:** Необходимость резервирования ресурсов может привести к неэффективному использованию инфраструктуры.
    
- P2P Архитектура
    
  - Плюсы
    - **Отказоустойчивость:** Система не зависит от центрального сервера, что делает ее более устойчивой к сбоям.
    - **Снижение нагрузки на серверы:** Распределение нагрузки между клиентами снижает требования к серверной инфраструктуре.
    - **Приватность данных:** Данные могут передаваться напрямую между пользователями без необходимости хранения на сервере.
    
  - Минусы
    - **Сложность реализации:** Реализация P2P-системы может быть сложной из-за необходимости обработки различных сетевых условий и обеспечения безопасности.
    - **Проблемы с синхронизацией:** Обеспечение консистентности данных между различными узлами может быть сложной задачей.
    - **Зависимость от клиентов:** Работоспособность системы зависит от доступности и производительности клиентских устройств.


## Решение

**Серверный**

## Обоснование

Выбор серверного подхода обусловлен следующими факторами:

1. **Доступность:** Клиенты смогут иметь доступ к своим документам в любое время с любого устройства.
2. **Масштабируемость:** На начальном этапе количество пользователей будет небольшим, что позволяет использовать один сервер. В дальнейшем возможен переход в Managed Cloud.
3. **Отказоустойчивость:** Будет обеспечиваться с помощью Blue-green deployment, развертыванием нескольких инстансов для обеспечения работы при падении одного из них.
4. **Безопасность данных:** Будет обеспечена с помощью application WAF и автоматического резервного копирования.

## Последствия

Так как требуется интернет-подключение, нашим клиентам потребуется загружать документы для офлайн просмотра.

### Риски

1. **Зависимость от интернет-соединения:** Необходимость подключения к интернету для доступа к документам.
   - **Решение:** Разработка функции офлайн-доступа к ранее загруженным документам.
   
2. **Потенциальные проблемы с масштабируемостью при резком увеличении нагрузки:**
   - **Решение:** Переход на облачные решения с автоматическим масштабированием при увеличении числа пользователей.

## Затронутые области

1. **Инфраструктура:** Необходимость настройки серверов и механизмов развертывания.
2. **Безопасность:** Реализация мер по защите данных и сетевой безопасности.
3. **Пользовательский интерфейс:** Возможность загрузки документов для офлайн доступа.

## История




- Решение о реализации P2P подхода было отклонено в пользу серверного потому что мы ориентируемся на более широкие клиентские массы и пользователи
не должны находиться в одной локальной сети.
