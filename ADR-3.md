# ADR - **Выбор архитектурного стиля**

**Участники:**
- Мухин
- Мухорин
- Пряшников

**Дата:** 28 сент. 2024 г.

**Статус:** Решено

## Контекст

- Команда: 3 балбеса
  - все трое сдали ООП малову на 5
  - один балбес знает все языки программирования и иммет опыт работы со всеми архитектурами
- Бюджет: 3 хотдога в неделю 
- Ресурсы: доступен проектный сервер (уже оплачен на 10 лет), два старых ноутбука, один модный MacBook Pro M1 Max 14" 64G 1Tb
- Сроки: на реализацию MVP имеется 6 месяцев
- Целевая аудитория: компании, отказывающиеся от зарубежных решений по редактированию документов.
- [Серверное решение](ADR-1.md) с возможностью переезда в Serverless в будущем
- [Golang](ADR-2.md)
- Долгосрок поддержка

Надо разработать систему онлайн документов с возможностью совместного доступа и редактирования - [Golang](ADR-2.md), реалтайм, расчётная нагрузка до 2000 RPM и 1000 keepalive sessions, приоритет на сокращении длины пакетов, так как канал [выбранного нами сервера](ADR-1.md) составляет всего 100Мбит (фактически 50-70Mbit при средней загрузке сети регионального оператора). Фото доступного при нашем текущем бюджете серверного оборудования ниже:



![Серверное оборудование](Pasted20240928101811.png)

## Рассматриваемые варианты

- Монолитная архитектура
	- Старомодно
	- Легко и приятно в разработке
    - Очень больно в поддержке в долгосрок
    - Легко писать спагетти
    - Удобно для одиночной разработки
	- Боль при масштабировании
	- Resilience: low (крашится всё разом под нагрузкой)
- Микросервисная архитектура
    - Хайп
    - Сложно в разработке
    - Сложно в поддержке
    - Сложнее писать спагетти
    - Легко масштабировать на кластер
    - Кушает больше ресурсов
    - Больше связующего кода
    - Удобно для enterprise разработки
    - Значительно сложнее архитектура
    - Resilience: high (depends on implementation) (в хорошем случае крашится не всё)
- Модульная архитектура
    - Модно
    - Средненько в разработке
    - Сложнее писать спагетти
    - Легко и приятно в поддержке
    - Чище кодик
    - Удобно для командной разработки
	- Та же боль при масштабировании что и у монолита
    - Немножко проще распилить на сервисы чем монолит
    - Resilience: low (крашится всё разом под нагрузкой)


## Решение

**Модульная**

## Обоснование

Выбор Модульной архитектуры следующими факторами:

1. **Модность:** Модное решение, его использует много программистов.
2. **Компетенции и сроки:** Наша команда объединяет несколько разработчиков на [Golang](ADR-2.md), что позволит параллелить работу в рамках модулей и уложиться в сроки.
3. **Одобрение архитектора:** Архитектор одобряет
4. **Разработка командой балбесов:** Модель организации кода подразумевает распутывание компонент высокой связности, введение обязательного уровня абстракции и уменьшение спагетти by design - идеально для команды балбесов.
5. **Поддержка:** Удобно в поддержке, в отличие от других двух вариантов.
5. **Масштабирование:** Неприятно масштабируется, но в будущем можно переехать на модные Микросервисы и вкусный Serverless.

## Последствия

**Плохая масштабируемость:** всё равно один инстанс будет обрабатывать много запросов.
  - **Решение:** сделать региональные инстансы или переезжать на модные Микросервисы и вкусный Serverless.

**Соблазн создать родной монолитик с макарошками в модуле:**  
  - **Решение:** проводить регулярные Code Review у менее опытных коллег.
### Риски
1. **Отказы при нагрузке**
   - **Решение:** заранее переписывать на микросервисы/горизонтально масштабироваться через кластеризацию клиентов или документов/вертикально масштабироваться через увеличение буджета

## Затронутые области

1. **Проектирование:** Необходимость принимать архитектурные решения с учётом особенностей многомодульной архитектуры.

## История

----
